<!--
    Copyright 2025
    Douglas M. Schauer, CISSP
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Top 10 Recent CVEs Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .copyright-badge {
            position: fixed;
            top: 8px;
            left: 12px;
            font-size: 10pt;          /* 10 point font size */
            color: #e5e7eb;           /* Tailwind gray-200 */
            z-index: 50;
            pointer-events: none;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-900 to-gray-800 text-white min-h-screen p-8">
    <!-- Copyright label -->
    <div class="copyright-badge">
        Â© 2025 Douglas M. Schauer, CISSP
    </div>

    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="text-center mb-12">
            <h1 class="text-5xl font-bold bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent mb-4">
                CVE Dashboard
            </h1>
            <p class="text-xl text-gray-300">Top 10 Most Recent CVEs - Real-time Updates</p>
        </div>

        <!-- Update Button -->
        <div class="flex justify-center mb-8">
            <button id="updateBtn" class="bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 px-8 py-4 rounded-xl text-lg font-semibold shadow-2xl hover:shadow-green-500/25 transition-all duration-300 transform hover:-translate-y-1">
                ðŸ”„ Update CVEs (Real-time)
            </button>
        </div>

        <!-- Stats Cards -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
            <div class="bg-gradient-to-br from-blue-500/20 to-blue-600/20 backdrop-blur-sm border border-blue-500/30 rounded-2xl p-8 text-center shadow-2xl hover:shadow-blue-500/20 transition-all duration-300">
                <div class="text-4xl font-bold text-blue-400 mb-2" id="totalCves">10</div>
                <div class="text-gray-300 font-medium">Total CVEs</div>
            </div>
            <div class="bg-gradient-to-br from-red-500/20 to-red-600/20 backdrop-blur-sm border border-red-500/30 rounded-2xl p-8 text-center shadow-2xl hover:shadow-red-500/20 transition-all duration-300">
                <div class="text-4xl font-bold text-red-400 mb-2" id="criticalCount">0</div>
                <div class="text-gray-300 font-medium">Critical</div>
            </div>
            <div class="bg-gradient-to-br from-orange-500/20 to-orange-600/20 backdrop-blur-sm border border-orange-500/30 rounded-2xl p-8 text-center shadow-2xl hover:shadow-orange-500/20 transition-all duration-300">
                <div class="text-4xl font-bold text-orange-400 mb-2" id="highCount">0</div>
                <div class="text-gray-300 font-medium">High</div>
            </div>
        </div>

        <!-- CVE Table -->
        <div class="bg-white/5 backdrop-blur-xl border border-white/10 rounded-3xl overflow-hidden shadow-2xl">
            <div class="p-8 border-b border-white/10">
                <h2 class="text-3xl font-bold text-white mb-2">Recent CVEs</h2>
                <p class="text-gray-400" id="lastUpdated">Last updated: Loading...</p>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead class="bg-white/5">
                        <tr>
                            <th class="px-6 py-6 text-left text-sm font-semibold text-white uppercase tracking-wider">CVE ID</th>
                            <th class="px-6 py-6 text-left text-sm font-semibold text-white uppercase tracking-wider">Description</th>
                            <th class="px-4 py-6 text-left text-sm font-semibold text-white uppercase tracking-wider">Published</th>
                            <th class="px-4 py-6 text-left text-sm font-semibold text-white uppercase tracking-wider">CVSS</th>
                            <th class="px-4 py-6 text-left text-sm font-semibold text-white uppercase tracking-wider">Severity</th>
                        </tr>
                    </thead>
                    <tbody id="cveTableBody" class="divide-y divide-white/10">
                        <!-- Dynamic content -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Status -->
        <div class="mt-8 text-center p-6 bg-white/5 rounded-2xl backdrop-blur-sm border border-white/10">
            <div id="statusMsg" class="text-lg font-medium text-gray-300">
                Ready to fetch latest CVEs...
            </div>
        </div>
    </div>

    <script>
        // Copyright 2025
        // Douglas M. Schauer, CISSP

        let cves = [];
        let lastUpdateTime = null;

        const severityColors = {
            CRITICAL: 'bg-red-500 text-white',
            HIGH: 'bg-orange-500 text-white',
            MEDIUM: 'bg-yellow-500 text-black',
            LOW: 'bg-green-500 text-white',
            UNKNOWN: 'bg-gray-500 text-white'
        };

        async function fetchCVEs() {
            const statusMsg = document.getElementById('statusMsg');
            statusMsg.textContent = 'Fetching latest CVEs...';
            statusMsg.className = 'text-lg font-medium text-blue-400';

            try {
                const endDate = new Date().toISOString();
                const startDate = new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString();

                const url = `https://services.nvd.nist.gov/rest/json/cves/2.0?resultsPerPage=10&startIndex=0&pubStartDate=${startDate}&pubEndDate=${endDate}`;
                const response = await fetch(url);

                if (!response.ok) {
                    throw new Error(`API request failed: ${response.status}`);
                }

                const data = await response.json();
                cves = processCVEs(data.vulnerabilities || []);
                renderDashboard();
                updateStats();

                lastUpdateTime = new Date().toLocaleString();
                document.getElementById('lastUpdated').textContent = `Last updated: ${lastUpdateTime}`;
                statusMsg.textContent = `Updated successfully! ${cves.length} CVEs loaded.`;
                statusMsg.className = 'text-lg font-medium text-green-400';
            } catch (error) {
                console.error('Error fetching CVEs:', error);
                statusMsg.textContent = `Error: ${error.message}. Using fallback data.`;
                statusMsg.className = 'text-lg font-medium text-red-400';
                cves = generateFallbackCVEs();
                renderDashboard();
                updateStats();
            }
        }

        function processCVEs(vulnerabilities) {
            return vulnerabilities.map(vuln => {
                const cve = vuln.cve;
                const descriptions = (cve.descriptions || []).filter(d => d.lang === 'en');
                const desc = descriptions[0]?.value || 'No description available';

                // Prefer CVSS v3.1, then v3.0, then v2 baseScore. [web:59][web:60]
                let cvssVersion = 'N/A';
                let cvssScore = 'N/A';
                let severity = 'UNKNOWN';

                const v31 = cve.metrics?.cvssMetricV31?.[0]?.cvssData;
                const v30 = cve.metrics?.cvssMetricV30?.[0]?.cvssData;
                const v2  = cve.metrics?.cvssMetricV2?.[0]?.cvssData;

                const cvssData = v31 || v30 || v2 || null;

                if (cvssData && typeof cvssData.baseScore === 'number') {
                    cvssScore = cvssData.baseScore.toFixed(1);
                    cvssVersion = cvssData.version || (v31 ? '3.1' : v30 ? '3.0' : v2 ? '2.0' : 'N/A');

                    const score = cvssData.baseScore;
                    if (score >= 9.0) severity = 'CRITICAL';
                    else if (score >= 7.0) severity = 'HIGH';
                    else if (score >= 4.0) severity = 'MEDIUM';
                    else if (score > 0) severity = 'LOW';
                    else severity = 'LOW';
                } else {
                    severity = 'LOW';
                }

                return {
                    id: cve.id,
                    description: desc.substring(0, 150) + '...',
                    published: cve.published ? new Date(cve.published).toLocaleDateString() : 'N/A',
                    severity: severity,
                    cvssScore: cvssScore,
                    cvssVersion: cvssVersion
                };
            });
        }

        function generateFallbackCVEs() {
            // Example fallback with indicative CVSS scores and severities. [web:59]
            return [
                { id: 'CVE-2025-54322', description: 'Xspeeder SXZOS RCE vulnerability via base64-encoded Python code...', published: '2025-12-28', severity: 'CRITICAL', cvssScore: '9.8', cvssVersion: '3.1' },
                { id: 'CVE-2025-15107', description: 'Actiontech SQLE SQL injection vulnerability up to version 4.2511.0...', published: '2025-12-27', severity: 'HIGH', cvssScore: '8.2', cvssVersion: '3.1' },
                { id: 'CVE-2025-66737', description: 'Yealink T21P_E2 phone directory traversal vulnerability...', published: '2025-12-26', severity: 'MEDIUM', cvssScore: '6.5', cvssVersion: '3.1' },
                { id: 'CVE-2025-67015', description: 'Comtech EF Data CDM-625 incorrect access control vulnerability...', published: '2025-12-25', severity: 'HIGH', cvssScore: '7.8', cvssVersion: '3.0' },
                { id: 'CVE-2025-67014', description: 'DEV Systemtechnik RF over Fiber incorrect access control...', published: '2025-12-24', severity: 'HIGH', cvssScore: '7.5', cvssVersion: '3.0' },
                { id: 'CVE-2025-66738', description: 'Yealink T21P_E2 phone arbitrary code execution vulnerability...', published: '2025-12-23', severity: 'HIGH', cvssScore: '8.0', cvssVersion: '3.1' },
                { id: 'CVE-2025-57403', description: 'Cola Dnslog directory traversal vulnerability...', published: '2025-12-22', severity: 'MEDIUM', cvssScore: '5.9', cvssVersion: '3.1' },
                { id: 'CVE-2025-64645', description: 'IBM Concert privilege escalation via race condition...', published: '2025-12-21', severity: 'HIGH', cvssScore: '7.4', cvssVersion: '3.1' },
                { id: 'CVE-2025-36230', description: 'IBM Aspera Faspex HTML injection vulnerability...', published: '2025-12-20', severity: 'MEDIUM', cvssScore: '6.1', cvssVersion: '3.0' },
                { id: 'CVE-2025-6204', description: 'Recent vulnerability in critical infrastructure component...', published: '2025-12-19', severity: 'CRITICAL', cvssScore: '9.1', cvssVersion: '3.1' }
            ];
        }

        function renderDashboard() {
            const tbody = document.getElementById('cveTableBody');
            tbody.innerHTML = cves.map(cve => {
                const nvdUrl = `https://nvd.nist.gov/vuln/detail/${cve.id}`;
                return `
                    <tr class="hover:bg-white/10 transition-colors duration-200">
                        <td class="px-6 py-6 font-mono font-semibold text-lg text-blue-400">
                            <a href="${nvdUrl}"
                               target="_blank"
                               rel="noopener noreferrer"
                               class="underline decoration-blue-500/60 hover:decoration-blue-300 hover:text-blue-300">
                                ${cve.id}
                            </a>
                        </td>
                        <td class="px-6 py-6 text-gray-200 max-w-md">${cve.description}</td>
                        <td class="px-4 py-6 text-sm text-gray-400">${cve.published}</td>
                        <td class="px-4 py-6 text-sm text-gray-200">
                            ${cve.cvssScore !== 'N/A'
                                ? `${cve.cvssScore} <span class="text-gray-400 text-xs">(v${cve.cvssVersion})</span>`
                                : 'N/A'}
                        </td>
                        <td class="px-4 py-6">
                            <span class="px-4 py-2 rounded-full text-xs font-bold ${severityColors[cve.severity] || severityColors.UNKNOWN}">
                                ${cve.severity}
                            </span>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function updateStats() {
            document.getElementById('totalCves').textContent = cves.length;
            const critical = cves.filter(c => c.severity === 'CRITICAL').length;
            const high = cves.filter(c => c.severity === 'HIGH').length;
            document.getElementById('criticalCount').textContent = critical;
            document.getElementById('highCount').textContent = high;
        }

        document.getElementById('updateBtn').addEventListener('click', fetchCVEs);

        fetchCVEs();
    </script>
</body>
</html>
